# Default values for data-product-hub.

namespaceOverride: ""

imagePullSecrets:
  - name: ghcr-auth

crd:
  group: sripathiacharya.gitbub.io
  kind: DataProduct
  plural: dataproducts
  singular: dataproduct
  shortNames:
    - dp
  version: v1alpha1

engine:
  enabled: true
  image:
    repository: ghcr.io/sripathiacharya/data-product-hub-engine
    tag: "0.1.0"
    pullPolicy: Always

  replicaCount: 1

  # Where Parquet & other data live inside the container
  dataRoot: "/data-product-hub-data"

  dataVolume:
    enabled: true
    # assume you create this PVC separately
    existingClaim: "data-product-hub-parquet-pvc"

  service:
    type: ClusterIP
    port: 8000        # Service port (external inside the cluster)
    targetPort: 8000  # Container port

operator:
  enabled: true
  image:
    repository: ghcr.io/sripathiacharya/data-product-hub-operator
    tag: "0.1.0"
    pullPolicy: Always

  replicaCount: 1

  # Configuration passed to the operator via env vars.
  config:
    # --- Shared engine wiring (for deploymentMode: Shared) ---
    sharedEngine:
      # If empty, the chart will use the engine fullname (e.g. <release>-data-product-hub-engine).
      serviceName: ""
      servicePort: 8000
      reloadPath: "/internal/reload-config"
      metadataConfigMapName: "data-product-hub-metadata"

    # --- Dedicated engine defaults (for deploymentMode: Dedicated) ---
    dedicatedEngine:
      # If inheritFromEngineImage = true, operator uses engine.image.* for dedicated engines.
      inheritFromEngineImage: true
      image:
        repository: ""   # only used if inheritFromEngineImage = false
        tag: ""
        pullPolicy: Always

      # Soft guardrail â€“ you can enforce in operator logic later if you want.
      maxCount: 100

    # --- Per-DataProduct ingress defaults (created by operator) ---
    ingress:
      createPerDataProduct: true

      # IngressClass to use (nginx, traefik, azure/application-gateway, etc.).
      className: "nginx"

      # All DataProducts will be exposed on this host; path is derived from pathPrefix + spec.api.path.
      baseHost: "dataproduct.example.com"

      # TLS secret for this host (optional).
      tlsSecretName: "dataproduct.example.com"

      # Prefix added in front of spec.api.path when creating ingress rules.
      # e.g. /odata + /southafrica-scheduled-outage-dataset -> /odata/southafrica-scheduled-outage-dataset
      pathPrefix: "/odata"

      # Operator will JSON-encode these and pass them in INGRESS_ANNOTATIONS_JSON.
      annotations: {}

rbac:
  create: true

resources:
  engine: {}
  operator: {}
