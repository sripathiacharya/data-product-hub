id: southafrica-scheduled-outage-dataset
route: southafrica-scheduled-outage-dataset

description: "Scheduled outage plan for South African suburbs, joining area metadata (province/city/suburb) with block-based load shedding schedules."

backend:
  engine: parquet_join

  sources:
    areas:
      path: sample-data/south-africa-outages/areas.parquet
      rename:
        province: province
        city: city
        suburb: suburb
        provider: provider
        block: block
        type: area_type

    schedule:
      path: sample-data/south-africa-outages/schedule.parquet
      rename:
        provider: provider
        block: block
        date: day
        start: start_time
        end: end_time
        stage: stage

  joins:
    - left: areas
      right: schedule
      "on": 
        - provider
        - block

entity:
  name: SouthAfricaScheduledOutage
  key_column: id

  columns:
    - name: id
      type: string
      generated: true

    - name: province
      type: string
    - name: city
      type: string
    - name: suburb
      type: string

    - name: provider
      type: string
    - name: block
      type: int
    - name: area_type
      type: string

    - name: day
      type: int
    - name: stage
      type: int

    - name: start_time
      type: string
    - name: end_time
      type: string

odata:
  max_top: 1000
  default_top: 100

  filterable:
    - province
    - city
    - suburb
    - provider
    - block
    - area_type
    - day
    - stage
    - start_time
    - end_time

  orderable:
    - province
    - city
    - suburb
    - provider
    - block
    - day
    - stage
    - start_time
    - end_time
